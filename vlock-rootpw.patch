--- vlock-1.3/input.c.orig	Thu Jan 14 01:19:14 1999
+++ vlock-1.3/input.c	Sun Jul 14 21:37:11 2002
@@ -110,6 +110,15 @@
   PAM_BAIL;
 #else
   if (pam_error != PAM_SUCCESS) {
+    if (geteuid()!=0) {
+      /* No root privileges - we can check only user's password.
+       * vlock must be setuid root to be able to check root password thru PAM.
+       * But it may be not secure...
+       * (vlock w/o PAM support drops root just after reading shadow) */
+      pam_end(pamh, 0);
+      set_signal_mask(0);
+      return 0;
+    }
     /* Try as root; bail if no success there either */
     printf("root's "); fflush(stdout);
     pam_error = pam_set_item(pamh, PAM_USER_PROMPT, strdup(prompt));
